<!-- Status of sheeet -->
<div class="statuses row">
  <button (click)="setStatus($event.target.textContent)" class="btn waves-effect waves-light col s6 m3 l3" [ngClass]="{ 'grey': sheet.status == 'Not Started Yet', 'grey lighten-5': sheet.status != 'Not Started Yet' }">Not Started Yet</button>
  <button (click)="setStatus($event.target.textContent)" class="btn waves-effect waves-light col s6 m3 l3" [ngClass]="{ 'red': sheet.status == 'On Hold', 'red lighten-5': sheet.status != 'On Hold' }">On Hold</button>
  <button (click)="setStatus($event.target.textContent)" class="btn waves-effect waves-light col s6 m3 l3" [ngClass]="{ 'blue': sheet.status == 'In Progress', 'blue lighten-5': sheet.status != 'In Progress' }">In Progress</button>
  <button (click)="setStatus($event.target.textContent)" class="btn waves-effect waves-light col s6 m3 l3" [ngClass]="{ 'green': sheet.status == 'Finished', 'green lighten-5': sheet.status != 'Finished' }">Finished</button>
</div>
<!-- Priority of sheet -->
<div class="priorities row">
  <button (click)="setPriority($event.target.textContent)" class="btn waves-effect waves-light col s6 m3 l3" [ngClass]="{ 'blue': sheet.priority == 'Low', 'blue lighten-5': sheet.priority != 'Low' }">Low</button>
  <button (click)="setPriority($event.target.textContent)" class="btn waves-effect waves-light col s6 m3 l3" [ngClass]="{ 'yellow': sheet.priority == 'Medium', 'yellow lighten-5': sheet.priority != 'Medium' }">Medium</button>
  <button (click)="setPriority($event.target.textContent)" class="btn waves-effect waves-light col s6 m3 l3" [ngClass]="{ 'red': sheet.priority == 'High', 'red lighten-5': sheet.priority != 'High' }">High</button>
</div>

<p> {{ sheet.status }} </p>

<div *ngIf="isSheetExpanded(); else isNotExpandedSheet">
  <p> {{ sheet._id }}</p>
  <a class="waves-effect waves-light btn-floating right squared extend-template-arrow" (click)="closeSheet()"><i class="material-icons left">expand_less</i></a>
  <a class="waves-effect waves-light btn-floating right squared extend-template-arrow red" (click)="deleteSheet(i)"><i class="material-icons left">delete_forever</i></a>  
  <a class="waves-effect waves-light btn-floating right squared extend-template-arrow grey" (click)="downloadPDF(i)"><i class="material-icons left">picture_as_pdf</i></a>
  <div class="center">
    <form [formGroup]="expandedSheetForm" (ngSubmit)="updateSheet()" novalidate>
      <ul class="row">
        <li class="col s12 m4 l2">
          <div class="input-field">
            <input formControlName="title" placeholder="Title" id="description" type="text" class="validate">
          </div>
          <div class="col s12 m6 l4">
          </div>
        </li>
        <li class="col s12 m6 l4">
          <div class="col s12">
            <div class="">
              <div class="input-field">
                <textarea formControlName="description" placeholder="Description" id="descriptionTextarea" class="materialize-textarea"></textarea>
              </div>
            </div>
          </div>
        </li>
        <li class="col s12 m6 l3 sheet" *ngFor="let item of expandedSheetForm.controls.items.controls; index as i">
          <div formArrayName="items">
            <form [formGroup]="item">
              <div [ngSwitch]="item.value.type">
                <!-- Header -->
                <div *ngSwitchCase="'header'">
                  <div class="inputElement">
                    <div class="input-field col s12">
                      <hr>
                      <label for="">Header</label>
                      <input formControlName="value" placeholder="Header" id="fieldHeader" type="text" class="validate">
                    </div>
                  </div>
                </div>
                <!-- Field inputs -->
                <div *ngSwitchCase="'inputFields'">
                  <div class="inputElement">
                    <div class="input-field">
                      <hr>
                      <b class="col s12 m12 l12 left-align"> {{ item.value.header }} </b>
                      <ul>
                        <li *ngFor="let inputField of expandedSheetForm.controls.items.controls[i].controls.inputs.controls; index as y">
                          <div formArrayName="inputs" class="row">
                            <form [formGroup]="inputField">
                              <div class="input-group">
                                <p class="col s6 m4 l2 field-header"> {{ inputField.value.header }} : </p>
                                <input class="col s6 m4 l2 validate" formControlName="value" placeholder="Value" id="fieldHeader" type="text">
                              </div>
                            </form>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <!-- Table -->
                <div *ngSwitchCase="'table'">
                
                </div>
                <!-- List -->
                <div *ngSwitchCase="'list'">
                
                </div>
                <!-- Checkboxes -->
                <div *ngSwitchCase="'checkboxes'">
                
                </div>
              </div>
            </form>
          </div>
        </li>
        <div class="row">
          <div class="col s12 m12 l12 left-align">
            <input type="submit" value="Edit Sheet" class="btn btn-small waves-effect waves-light blue lighten-2">
          </div>
        </div>
      </ul>
    </form>
  </div>
</div>

  <ng-template #isNotExpandedSheet>
   <div id="sheet">
     <a class="waves-effect waves-light btn-floating right squared extend-sheet-arrow" (click)="expandSheet(i)"><i class="material-icons left">expand_more</i></a>
     <a class="waves-effect waves-light btn-floating right squared extend-sheet-arrow red" (click)="deleteSheet(i)"><i class="material-icons left">delete</i></a>
     <a class="waves-effect waves-light btn-floating right squared extend-template-arrow grey" (click)="downloadPDF(i)"><i class="material-icons left">picture_as_pdf</i></a>
     <ul>
       <li>
         <div class="col s12 m4 l2">
           <p class="title"> {{ sheet.title }} </p>
         </div>
       </li>
       <li class="col s12 m6 l4">
       </li>
       <li class="row">
         <div class="col s12">
           <p> {{ sheet.description }} </p>
         </div>
       </li>
       <li *ngFor="let item of sheet.items; index as i" class="row">
         <div [ngSwitch]="item.type">
           <!-- Header -->
           <div *ngSwitchCase="'header'">
             <div class="inputElement">
               <div class="input-field">
                 <hr>
                 <label for="">Header</label>
                 <p class="col s12 m12 l12"> {{ item.value.value }} </p>
               </div>
             </div>
           </div>
           <!-- Field inputs -->
           <div *ngSwitchCase="'inputFields'">
             <div class="inputElement">
               <div class="input-field">
                 <hr>
                 <b class="col s12 m12 l12"> {{ item.header }} </b>
                 <ul>
                   <li class="row" *ngFor="let inputField of sheet.items[i].inputs; index as y">
                     <div class="input-group">
                       <b class="col s6 m4 l2"> {{ inputField.header }} : </b>
                       <p class="col s6 m4 l2"> {{ inputField.value }} </p>
                     </div>
                   </li>
                 </ul>
               </div>
             </div>
           </div>
           <!-- Table -->
           <div *ngSwitchCase="'table'">
          
           </div>
           <!-- List -->
           <div *ngSwitchCase="'list'">
          
           </div>
           <!-- Checkboxes -->
           <div *ngSwitchCase="'checkboxes'">
          
           </div>
        </div>
      </li>
    </ul>
  </div>
</ng-template>